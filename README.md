# T-Bank Logo Detector API

Целью задания было создать REST API сервис для детекции логотипа Т-Банка на изображениях. Сервис возвращает абсолютные координаты bounding box’ов найденных логотипов.

---

## Оглавление

- [Описание задачи](#-описание-задачи)
- [Архитектура решения](#-архитектура-решения)
- [Подготовка данных и разметка](#-подготовка-данных-и-разметка)
- [Обучение модели](#-обучение-модели)
- [REST API сервис](#-rest-api-сервис)
- [Валидация и метрики качества](#-валидация-и-метрики-качества)
- [Запуск с помощью Docker](#-запуск-с-помощью-docker)
- [Использование API](#-использование-api)
- [Результаты на валидационной выборке](#-результаты-на-валидационной-выборке)
- [Альтернативные подходы и анализ](#-альтернативные-подходы-и-анализ)
- [Ссылки на ресурсы](#-ссылки-на-ресурсы)

---

## Описание задачи

Цель проекта — создать REST API сервис, способный детектировать логотип Т-Банка на изображениях и возвращать абсолютные координаты bounding box.

**Требования:**
- Поддержка форматов: `JPEG`, `PNG`, `BMP`, `WEBP`
- Время обработки <= 10 сек/изображение
- Запуск на GPU с 16 ГБ памяти
- API по контракту
- Упаковка в Docker-контейнер

---

## Архитектура решения

Решение состоит из 3 этапов:

1. **Zero-shot разметка данных** — с помощью `Grounding DINO`
2. **Обучение детектора** — файнтюнинг `YOLOv8m`
3. **Развертывание API** — FastAPI + Docker

Сырые изображения --> Grounding DINO --> Фильтрация + ручная проверка --> дообучение YOLOv8m --> FastAPI + Docker --> REST API /detect

**Подготовка данных и разметка**

Исходные данные: 
Использован предоставленный организаторами датасет

Для автоматической разметки использована модель Grounding DINO. 
Промпт:
"T-Bank logo, stylized letter T inside a shield" 

Процесс: 
    Запуск модели по всем изображениям
    Фильтрация: оставляем только изображения, похожие на нужный логотип
    Для каждого изображения — выбор одного bbox с максимальным similarity_score.
    Визуальная проверка изображений, удаление ложных срабатываний.
    Конвертация в формат YOLO 
     
 
**Обучение модели**
Выбор модели 

Использована YOLOv8s — оптимальный баланс скорости и точности. 


Лучшая модель: models/best.pt 

 
**Валидация и метрики качества**

Скрипт валидации 

Файл: scripts/validate.py 

Функционал: 

    Загружает модель и валидационный набор.
    Прогоняет предсказания.
    Считает Precision, Recall, F1-score @ IoU=0.5.
    Сохраняет визуализации с наложенными bbox’ами.

 Метрики на валидации: 

Precision: 0.8325
Recall: 0.7718
F1-score: 0.8010

     
 
Запуск с помощью Docker 
Требования 

    Docker
    NVIDIA Container Toolkit (для GPU)
     

Инструкции 

git clone https://github.com/your-username/tbank-logo-detector.git
cd tbank-logo-detector

docker build -t tbank-detector .

docker run --gpus all -p 8000:8000 tbank-detector
 

Документация API:
http://localhost:8000/docs  
 
Использование API 

curl -X POST "http://localhost:8000/detect" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@test_image.jpg" \
  | jq
 

Анализ проблем 

    Ложные срабатывания — решено фильтрацией и ручной проверкой.
    Мелкие логотипы — улучшено аугментациями и архитектурой YOLOv8.
    Разные цвета — решено HSV-аугментациями.
     
